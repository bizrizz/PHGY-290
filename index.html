<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Rapid Interview with Affirmations</title>
  <style>
    /* Basic reset and styling */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(to bottom right, #e8ebf0, #ffffff);
      color: #333;
      text-align: center;
    }
    .container {
      width: 100%;
      height: 100%;
      position: relative;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .screen {
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-sizing: border-box;
    }
    .screen.active {
      display: flex;
    }
    h1, h2, p {
      margin: 10px auto;
      padding: 0;
    }
    button {
      background-color: #6fa8dc;
      color: white;
      font-size: 18px;
      border-radius: 5px;
      padding: 12px 24px;
      border: none;
      cursor: pointer;
      margin: 10px;
    }
    button:hover {
      background-color: #86c0f5;
    }
    #questionText {
      font-size: 2.5em;
      font-weight: 600;
      line-height: 1.3em;
      margin-bottom: 30px;
    }
    .wave-container {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      width: 80%;
      max-width: 800px;
      height: 80px;
      margin: 15px 0;
    }
    .wave-bar {
      width: 8px;
      background-color: #6fa8dc;
      margin: 0 5px;
      border-radius: 3px;
      height: 20%;
      transition: height 0.2s ease-in-out;
    }
    .hidden {
      display: none !important;
    }
    #statusMessage {
      margin-top: 10px;
      font-size: 16px;
      color: #555;
      min-height: 24px;
    }
    /* Notification popup used for affirmation (typewriter animated) */
    #notificationPopup {
      position: fixed;
      top: 10px;
      right: 10px;
      font-size: 2.5em;
      font-weight: bold;
      color: black;
      display: none;
      text-align: left;
    }
  </style>
</head>
<body>
<div class="container">
  <!-- Notification Popup for affirmation -->
  <div id="notificationPopup"></div>

  <!-- 1) Welcome Screen -->
  <div id="welcomeScreen" class="screen active">
    <h2>Rapid-Fire Opinion Interview</h2>
    <p>Click the button below to begin.</p>
    <button id="startRapidInterviewBtn">Start Interview</button>
  </div>

  <!-- 2) Question Screen -->
  <div id="questionScreen" class="screen">
    <div id="questionText"></div>
    <div class="wave-container hidden" id="waveContainer">
      <div class="wave-bar"></div>
      <div class="wave-bar"></div>
      <div class="wave-bar"></div>
      <div class="wave-bar"></div>
      <div class="wave-bar"></div>
    </div>
    <p id="statusMessage"></p>
    <button id="actionButton">I'm Done</button>
  </div>

  <!-- 3) Thank You Screen -->
  <div id="thanksScreen" class="screen">
    <h2>Thank you for sharing your opinions!</h2>
  </div>
</div>

<script>
/* ========================= QUESTION BANK & RAPID QUESTIONS ========================= */
const RAPID_QUESTIONS = [
  "What’s something you do differently than most people?",
  "What’s a small habit that’s had a big impact on your life?"
];

/* ========================= DOM ELEMENTS ========================= */
const welcomeScreen    = document.getElementById("welcomeScreen");
const questionScreen   = document.getElementById("questionScreen");
const thanksScreen     = document.getElementById("thanksScreen");

const startRapidInterviewBtn = document.getElementById("startRapidInterviewBtn");
const actionButton = document.getElementById("actionButton");

const questionTextEl   = document.getElementById("questionText");
const waveContainer    = document.getElementById("waveContainer");
const statusMessage    = document.getElementById("statusMessage");
const notificationPopup = document.getElementById("notificationPopup");

/* ========================= STATE ========================= */
let questionIndex = 0;
let isAwaitingNext = false;
let waveInterval  = null;

/* ========================= TYPEWRITER ANIMATION ========================= */
function typeWriter(text, element, callback) {
  let i = 0;
  element.textContent = "";
  const speed = 50; // ms per letter
  const interval = setInterval(() => {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
    } else {
      clearInterval(interval);
      // Append a thumbs up emoji after the text is complete.
      element.textContent += " 👍";
      callback();
    }
  }, speed);
}

/* ========================= FEEDBACK DISPLAY (via notification popup) ========================= */
/* When the user is done, hide question text and button, then show the affirmation message
   in the notification popup using typewriter animation. The notification remains visible for
   10 seconds before the Next Question button appears.
*/
function displayAffirmation(callback) {
  // Hide question text and button.
  questionTextEl.style.display = "none";
  actionButton.style.display = "none";
  statusMessage.textContent = "";
  
  // Show notification popup.
  notificationPopup.style.display = "block";
  
  // Start typewriter animation for the affirmation.
  typeWriter("That's a very unique answer, you must be very disciplined to do that", notificationPopup, function() {
    // Keep the affirmation visible for 10 seconds.
    setTimeout(function() {
      notificationPopup.style.display = "none";
      callback();
    }, 10000);
  });
}

/* ========================= WAVE ANIMATION ========================= */
function startWaveAnimation() {
  waveContainer.classList.remove("hidden");
  waveInterval = setInterval(() => {
    const bars = waveContainer.querySelectorAll(".wave-bar");
    bars.forEach(bar => {
      let h = Math.floor(Math.random() * 80) + 20;
      bar.style.height = h + "%";
    });
  }, 200);
}
function stopWaveAnimation() {
  if (waveInterval) clearInterval(waveInterval);
  waveInterval = null;
  waveContainer.classList.add("hidden");
  const bars = waveContainer.querySelectorAll(".wave-bar");
  bars.forEach(bar => bar.style.height = "20%");
}

/* ========================= RAPID MODE LOGIC ========================= */
function startRapidMode() {
  questionIndex = 0;
  showScreen("questionScreen");
  showRapidQuestion(questionIndex);
}

function showRapidQuestion(idx) {
  if (idx >= RAPID_QUESTIONS.length) {
    showScreen("thanksScreen");
    return;
  }
  // Reset displays.
  questionTextEl.style.display = "block";
  actionButton.style.display = "block";
  notificationPopup.style.display = "none";
  
  // Prepare the question screen for a new question.
  questionTextEl.textContent = RAPID_QUESTIONS[idx];
  statusMessage.textContent = "Answer the question and click 'I'm Done' when finished.";
  actionButton.textContent = "I'm Done";
  isAwaitingNext = false;
  startWaveAnimation();
}

/* ========================= EVENT LISTENERS ========================= */
startRapidInterviewBtn.onclick = startRapidMode;

actionButton.onclick = function() {
  if (!isAwaitingNext) {
    // User indicates they're done with the question.
    stopWaveAnimation();
    statusMessage.textContent = "";
    // Display affirmation in the notification popup with typewriter animation.
    displayAffirmation(function() {
      // After the affirmation has been visible for 10 seconds,
      // hide the notification and reveal the "Next Question" button.
      actionButton.textContent = "Next Question";
      actionButton.style.display = "block";
      statusMessage.textContent = "Click 'Next Question' to continue.";
      // Restore question text visibility (for next question).
      questionTextEl.style.display = "block";
      isAwaitingNext = true;
    });
  } else {
    // Proceed to the next question.
    questionIndex++;
    showRapidQuestion(questionIndex);
  }
};

/* ========================= SCREEN NAVIGATION ========================= */
function showScreen(screenId) {
  welcomeScreen.classList.remove("active");
  questionScreen.classList.remove("active");
  thanksScreen.classList.remove("active");
  document.getElementById(screenId).classList.add("active");
}
</script>
</body>
</html>
